<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=BBH+Bogle&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/style.css">
    <link rel="stylesheet" href="/src/wallet.css">
    <title>Safe Solver</title>
  </head>
  <body>
    <div id="app-container">
      <header id="game-header">
        <h1>Safe Solver</h1>
        <div id="tokens-section" style="display: flex; align-items: center; gap: 20px;">
            <div id="tokens-display" style="font-weight: bold; font-size: 18px;">Gold Points: 0</div>
            <button id="btn-add-tokens">ADD tokens</button>
        </div>
        <button id="btn-mute">üîä</button>
        <button id="btn-set-name" style="display: none;">SET NAME</button>
        <button id="btn-connect-wallet">CONNECT WALLET</button>
      </header>
      <div id="game-layout">
        <div id="game-view">
          <div id="hud-center">
            <div id="score">Score: 1.00</div>
            <div id="info">Choose a safe to open...</div>
            <button id="btn-cash-out" class="hidden">KEEP REWARD</button>
          </div>
          <div id="level">Level: 1</div>
          <div id="multiplier-badge" class="hidden">
            <div class="ribbon-rotating">
                <div class="ribbon-text">
                    <span class="mult-val" id="multiplier-value">1.0x</span>
                    <span class="mult-label">PRIZE</span>
                </div>
            </div>
          </div>
          <div id="main-screen">
            <h1>Safe Solver</h1>
            <button id="btn-start">START</button>
            <button id="btn-how-to-play">How to Play</button>
          </div>
        </div>
        <aside id="leaderboard">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
            <h2 style="margin: 0;">Leaderboard</h2>
            <button id="btn-refresh-leaderboard" style="cursor: pointer; padding: 2px 8px; font-size: 16px; background: none; border: 1px solid white; color: white; border-radius: 4px;" title="Refresh">‚Üª</button>
          </div>
          <div id="leaderboard-header">
            <span>Place</span>
            <span>Address</span>
            <span>Points</span>
          </div>
          <ul id="leaderboard-list">
            <!-- Items injected by JS -->
          </ul>
        </aside>
      </div>
    </div>
    <div id="wallet-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-modal">&times;</span>
        <h2>Connect Wallet</h2>
        <p>Enter the wallet address you want to delegate to (e.g. your main wallet):</p>
        <input type="text" id="input-delegate-address" placeholder="0x..." style="width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box; font-family: monospace;" />
        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px;">
          <button id="btn-confirm-connect-wallet" style="padding: 10px 20px; cursor: pointer;">Connect</button>
          <button id="btn-cancel-connect-wallet" style="padding: 10px 20px; cursor: pointer;">Cancel</button>
        </div>
      </div>
    </div>
    <div id="add-tokens-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-add-tokens-modal">&times;</span>
        <h2>Add Tokens</h2>
        <p>Add 10 tokens to your balance?</p>
        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px;">
          <button id="btn-confirm-add-tokens" style="padding: 10px 20px; cursor: pointer;">Confirm</button>
          <button id="btn-cancel-add-tokens" style="padding: 10px 20px; cursor: pointer;">Cancel</button>
        </div>
      </div>
    </div>
    <div id="set-name-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-set-name-modal">&times;</span>
        <h2>Set Name</h2>
        <p>Enter your name:</p>
        <input type="text" id="input-player-name" placeholder="Your Name" style="width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box;" />
        <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px;">
          <button id="btn-confirm-set-name" style="padding: 10px 20px; cursor: pointer;">Save</button>
          <button id="btn-cancel-set-name" style="padding: 10px 20px; cursor: pointer;">Cancel</button>
        </div>
      </div>
    </div>
    <div id="alert-modal" class="modal">
      <div class="modal-content">
        <span class="close" id="close-alert-modal">&times;</span>
        <h2 id="alert-title">Safe Solver</h2>
        <p id="alert-message"></p>
        <div style="display: flex; justify-content: center; margin-top: 20px;">
          <button id="btn-alert-ok" style="padding: 10px 20px; cursor: pointer;">OK</button>
        </div>
      </div>
    </div>
    <div id="how-to-play-modal" class="modal">
        <div class="modal-content">
            <span class="close" id="close-how-to-play-modal">&times;</span>
            <h2>How to Play</h2>
            <div style="text-align: left; line-height: 1.6;">
                <p><strong>Goal:</strong> Find the prize hidden in the safes to advance levels and multiply your score!</p>
                <ul style="margin-bottom: 20px;">
                    <li><strong>Start:</strong> You will see some safes and you can either:</li>
                    <li><strong>Pick a Safe:</strong> Click a safe to drill it.
                        <ul>
                            <li>‚úÖ <strong>Win:</strong> If it has gold, you get points and move to the next level.</li>
                            <li>‚ùå <strong>Lose:</strong> The alarm goes off (bad safe), the game ends immediately!</li>
                        </ul>
                    </li>
                    <li><strong>or Cash Out:</strong> Press "KEEP REWARD" at any time to add your current score to the leaderboard. If you lose, you get 0!</li>
                </ul>
                <hr style="border: 0; border-top: 1px solid #ccc; margin: 20px 0;">
                <h3>Connect Your Real Wallet</h3>
                <p>To delegate your game progress to a wallet address (e.g. your main wallet):</p>
                <ol>
                    <li>Click the <strong>CONNECT WALLET</strong> button in the top right.</li>
                    <li>Enter the wallet address you want to delegate to.</li>
                    <li>Confirm to send the delegation; your local account will be linked to that address.</li>
                </ol>
            </div>
            <div style="display: flex; justify-content: center; margin-top: 20px;">
                <button id="btn-how-to-play-ok" style="padding: 10px 20px; cursor: pointer;">Got it!</button>
            </div>
        </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
